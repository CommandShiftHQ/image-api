<!DOCTYPE html>
<html>
  <head>
    <title>Manchester Codes Image Sharing API</title>
    <!-- <link rel="stylesheet" type="text/css" href="index.css"> -->
  </head>
  <body>
    <main>
      <h1>Manchester Codes Image Sharing API</h1>

      <section id="endpoints">
        <h2>Endpoints</h2>

        <section id="auth">
          <h3>Authentication</h3>
          <p>Users can authenticate themselves using either an email/password or with Google OAuth</p>
          <section id="post-auth-login">
            <h3><code>POST /auth/login</code></h3>
            <p>Logs a user in with an email and password</p>
            <h4>Request Body Params:</h4>
            <ul>
              <li><code>email</code> - users email address</li>
              <li><code>password</code> - users password</li>
            </ul>
            <h4>Response:</h4>
            <ul>
              <li><code>token</code> - JWT containing the users details</li>
            </ul>
          </section>
          <section id="post-auth-google">
            <h3><code>POST /auth/google</code></h3>
            <p>Logs a user in, or creates a new users account if one doesn't exist with the selected email address</p>
            <p>To authenticate with Google, you should redirect the user to the following URL:</p>
            <p><code>https://accounts.google.com/o/oauth2/v2/auth</code></p>
            <p>with the following query params:
              <ul>
                <li>
                  <code>
                    scope: https://www.googleapis.com/auth/plus.me https://www.googleapis.com/auth/userinfo.profile https://www.googleapis.com/auth/userinfo.email
                  </code>
                </li>
                <li>
                  <code>
                    redirect_uri: http://localhost:8080/google-auth
                  </code>
                </li>
                <li>
                  <code>
                    client_id: Ask a tutor for this credential.
                  </code>
                </li>
              </ul>
            </p>

            <p>
              This will redirect back to your client application with either a <code>code</code> or <code>error</code> query parameter.
            </p>
            <p>
              If a code is returned, this should be forwarded to the <code>/auth/google</code> API endpoint.
              If an error is returned, this should be handled in the client.
            </p>
            <h4>Request Body Params:</h4>
            <ul>
              <li><code>code</code> - temporary auth token provided by Google</li>
            </ul>
            <h4>Response:</h4>
            <ul>
              <li><code>token</code> - JWT containing the users details</li>
            </ul>
          </section>
        </section>

        <hr />

        <section id="users">
          <h3>Users</h3>
          <section id="post-users">
            <h3><code>POST /users</code></h3>
            <p>Creates a new user</p>
            <h4>Request Headers:</h4>
            <ul>
              <li>
                <code>Content-Type</code> - either <code>application/json</code> (if no image is present) or <code>multipart/form-data</code> (if image is present)
              </li>
            </ul>
            <h4>Request Body Params:</h4>
            <ul>
              <li><code>firstName</code> - string -  users first name - required</li>
              <li><code>lastName</code> - string - users email address - required</li>
              <li><code>email</code> - string - users email address - required</li>
              <li><code>password</code> - string - users password - required</li>
              <li><code>avatar</code> - file - profile image. Valid mimetypes include 'image/jpeg', 'image/png' and 'image/gif' - optional</li>
            </ul>
            <h4>Response:</h4>
            <ul>
              <li>
                <code>_id</code> - string - users unique id
              </li>
              <li>
                <code>firstName</code> - string - users first name
              </li>
              <li>
                <code>lastName</code> - string - users last name
              </li>
              <li>
                <code>avatar</code> - string - URL of users avatar
              </li>
              <li>
                <code>images</code> - array[Image] - array of images - see image endpoints for more details.
              </li>
            </ul>
          </section>

          <section id="get-user">
            <h3><code>GET /users/:id</code></h3>
            <p>Returns the profile of a user with the given ID</p>
            <h4>Request Headers:</h4>
            <ul>
              <li>
                <code>Authorization</code> - a valid JWT (optional). If provided, the returned image data will contain details of whether the authenticated user has liked the image.
              </li>
            </ul>
            <h4>Route Params:</h4>
            <ul>
              <li><code>id</code> - A valid user ID</li>
            </ul>
            <h4>Response:</h4>
            <ul>
              <li>
                <code>_id</code> - string - users unique id
              </li>
              <li>
                <code>firstName</code> - string - users first name
              </li>
              <li>
                <code>lastName</code> - string - users last name
              </li>
              <li>
                <code>avatar</code> - string - URL of users avatar
              </li>
              <li>
                <code>images</code> - array[Images] - array of images belonging to the user - see image endpoints for more details.
              </li>
            </ul>
          </section>

          <section id="get-me">
            <h3><code>GET /me</code></h3>
            <p>Returns the profile of the authenticated user</p>
            <h4>Request Headers:</h4>
            <ul>
              <li>
                <code>Authorization</code> - required - a valid JWT.
              </li>
            </ul>
            <h4>Response:</h4>
            <ul>
              <li>
                <code>_id</code> - string - users unique id
              </li>
              <li>
                <code>firstName</code> - string - users first name
              </li>
              <li>
                <code>lastName</code> - string - users last name
              </li>
              <li>
                <code>email</code> - string - users email address
              </li>
              <li>
                <code>avatar</code> - string - URL of users avatar
              </li>
              <li>
                <code>images</code> - array[Images] - array of images belonging to the user - see image endpoints for more details.
              </li>
            </ul>
          </section>

          <section id="patch-me">
            <h3><code>PATCH /me</code></h3>
            <p>Updates fields on the authenticated users profile</p>
            <h4>Request Headers:</h4>
            <ul>
              <li>
                <code>Authorization</code> - required - a valid JWT.
              </li>
              <li>
                <code>Content-Type</code> - either <code>application/json</code> (if no image is present) or <code>multipart/form-data</code>
                (if image is present)
              </li>
            </ul>
            <h4>Request Body Params:</h4>
            <ul>
                <li><code>firstName</code> - string - users first name - optional</li>
                <li><code>lastName</code> - string - users email address - optional</li>
                <li><code>password</code> - string - users password - optional</li>
                <li><code>avatar</code> - file - profile image. Valid mimetypes include 'image/jpeg', 'image/png' and 'image/gif' -
                  optional</li>
            </ul>
            <h4>Response:</h4>
            <ul>
              <li>
                <code>_id</code> - string - users unique id
              </li>
              <li>
                <code>firstName</code> - string - users first name
              </li>
              <li>
                <code>lastName</code> - string - users last name
              </li>
              <li>
                <code>email</code> - string - users email address
              </li>
              <li>
                <code>avatar</code> - string - URL of users avatar
              </li>
              <li>
                <code>images</code> - array[Image] - array of images belonging to the user - see image endpoints for more details.
              </li>
            </ul>
          </section>

          <section id="delete-me">
            <h3><code>DELETE /me</code></h3>
            <p>Deletes the authenticated users profile</p>
            <h4>Request Headers:</h4>
            <ul>
              <li>
                <code>Authorization</code> - required - a valid JWT.
              </li>
            </ul>
            <h4>Response:</h4>
            <h5>Status: 204 - No Content</h5>
          </section>

        </section>

        <hr />

        <section id="images">
          <h3>Images</h3>
          An <code>Image</code> object returned from the API will have the following structure:
          <ul>
            <li>
              <code>_id</code> - string - unique id of image
            </li>
            <li>
              <code>user</code> - string - unique id of the user who uploaded the image
            </li>
            <li>
              <code>src</code> - string - url to the full image
            </li>
            <li>
              <code>thumb</code> - string - url to the image thumbnail (300 x 300)
            </li>
            <li>
              <code>caption</code> - string - image caption
            </li>
            <li>
              <code>tags</code> - array[string] - array of searchable tags
            </li>
            <li>
              <code>comments</code> - array[Comment] - array of comments (see below)
            </li>
            <li>
              <code>timestamp</code> - int - upload time of image in unix milliseconds
            </li>
            <li>
              <code>likes</code> - int - number of times the image has been liked
            </li>
            <li>
              <code>isLiked</code> - bool - <code>true</code> if the authenticated user has liked the image. <code>false</code> if the user has not liked
              the image, or if there is no authenticated user.
            </li>
          </ul>

          <section id="get-images">
            <h3><code>GET /images</code></h3>
            <p>Returns a list of images</p>
            <h4>Request Headers:</h4>
            <ul>
              <li>
                <code>Authorization</code> - optional - a valid JWT.
              </li>
            </ul>
            <h4>Query Parameters:</h4>
            <ul>
              <li>
                <code>tags</code> - array[string] - array of tags to filter response by. Only images with matching tags will be returned
              </li>
            </ul>
            <h4>Response:</h4>
            An array of <code>Image</code> objects as defined above
          </section>
          <section id="post-images">
            <h3><code>POST /images</code></h3>
            <p>Creates a new image</p>
            <h4>Request Headers:</h4>
            <ul>
              <li>
                <code>Authorization</code> - required - a valid JWT.
              </li>
              <li>
                <code>Content-Type</code> - must be <code>multipart/form-data</code>
              </li>
            </ul>
            <h4>Request Body Params:</h4>
            <ul>
              <li>
                <code>caption</code> - string - image caption - required
              </li>
              <li>
                <code>tags</code> - array[string] - array of searchable tags - optional - defaults to an empty array
              </li>
              <li>
                <code>image</code> - file - Valid mimetypes include 'image/jpeg', 'image/png' and 'image/gif' - required
              </li>
            </ul>
            <h4>Response:</h4>
            A new <code>Image</code> object (as defined above) representing the uploaded image
            </section>
          </section>
          <section id="get-image">
            <h3><code>get /images/:id</code></h3>
            <p>Returns a single image with the given id</p>
            <h4>Request Headers:</h4>
            <ul>
              <li>
                <code>Authorization</code> - optional - a valid JWT.
              </li>
            </ul>
            <h4>Response:</h4>
            The requested <code>Image</code> object (as defined above).
            </section>
          </section>
          <section id="patch-image">
            <h3><code>PATCH /images/:id</code></h3>
            <p>Updates the image with the given id</p>
            <h4>Request Headers:</h4>
            <ul>
              <li>
                <code>Authorization</code> - required - a valid JWT.
              </li>
            </ul>
            <h4>Request Body Params:</h4>
            <ul>
              <li>
                <code>caption</code> - string - image caption - optional
              </li>
              <li>
                <code>tags</code> - array[string] - array of searchable tags - optional - defaults to an empty array
              </li>
            </ul>
            <h4>Response:</h4>
            An <code>Image</code> object (as defined above) representing the updated image
            </section>
          </section>
          <section id="delete-image">
            <h3><code>DELETE /images/:id</code></h3>
            <p>Deletes the image with the given id</p>
            <h4>Request Headers:</h4>
            <ul>
              <li>
                <code>Authorization</code> - required - a valid JWT.
              </li>
            </ul>
            <h4>Response:</h4>
            <h5>Status: 204 - No Content</h5>
          </section>
        </section>

        <hr />

        <section id="comments">
          <code>Comment</code> objects returned from the API (including those embedded in <code>Image</code> objects) will have the following structure:
          <ul>
            <li>
              <code>_id</code> - string - unique id of the comment
            </li>
            <li>
              <code>author</code> - string - unique id of the user who added the comment
            </li>
            <li>
              <code>content</code> - string - the comment text
            </li>
            <li>
              <code>timestamp</code> - int - added time of comment in unix milliseconds
            </li>
          </ul>
          <h3>Comments</h3>
          <section id="post-image-comments">
            <h3><code>POST /images/:id/comments</code></h3>
            <p>Adds a comment to an image</p>
            <h4>Request Headers:</h4>
            <ul>
              <li>
                <code>Authorization</code> - required - a valid JWT.
              </li>
            </ul>
            <h4>Request Body Params:</h4>
            <ul>
              <li>
                <code>content</code> - string - comment text - required
              </li>
            </ul>
            <h4>Response:</h4>
            A <code>Comment</code> object (as defined above) representing the new comment
          </section>
          <section id="delete-image-comment">
            <h3><code>DELETE /images/:imageId/comments/:commentId</code></h3>
            <p>Deletes a comment from an image</p>
            <h4>Request Headers:</h4>
            <ul>
              <li>
                <code>Authorization</code> - required - a valid JWT.
              </li>
            </ul>
            <h4>Response:</h4>
            <h5>Status: 204 - No Content</h5>
          </section>
        </section>

        <hr />

        <section id="likes">
          <h3>Likes</h3>
          <section id="patch-image-likes">
            <h3><code>PATCH /images/:id/likes</code></h3>
            <p>Likes or unlikes an image</p>
            <h4>Request Headers:</h4>
            <ul>
              <li>
                <code>Authorization</code> - required - a valid JWT.
              </li>
            </ul>
            <h4>Response:</h4>
            An <code>Image</code> object (as defined above) representing the updated image
            </section>
          </section>
        </section>
      </section>
    </main>
  </body>
</html>

